// INPUT: a (newly created) block Bl
// return a list Bi of 0,1 or 2 blocks equal to Bl with updated support sphere radius
// the formulas are optimized for each case

auto update_block(block Bl)
{
    I x0=square(Bl[0]);
    I x1=square(Bl[1]);
    I x2=square(Bl[2]);
    I x3=square(Bl[3]);
    I x4=square(Bl[4]);
    I x5=square(Bl[5]);

    #if defined(case_1)
	I A=(I(4)*x4+(x3+x2-I(4)-x5-x4)*x3-I(4)*x5)*(-I(4)*x2)+(x4*(x3+x2+I(4)+x5-x1-x4)+(x2-I(4))*(x3-x5))*(I(4)*x1)+(x3*(x4-I(4))+I(16)+I(4)*x5-I(4)*x4)*(-I(4)*x5);
	I B=(I(4)*x4+(x3+x2-I(4)-x5-x4)*x3-I(4)*x5)*(-I(8)*x2)+(x4*(x3+x2+I(4)+x5-x1-x4)+(x2-I(4))*(x3-x5))*(I(8)*x1)+(x3*(x4-I(4))+I(16)+I(4)*x5-I(4)*x4)*(-I(8)*x5);
	I C=x1*((I(4)*x4+(x4-I(4))*(-x1)+(x3-I(2))*(I(2)*x2)+I(4)*x5-I(16)-I(4)*x3)*(-x4)+(x3-x5)*(I(4)*x2-I(16)))+(x3-I(4))*((x4-I(4))*(-I(4)*x5)+x2*(I(4)*x4+x3*(x2-I(4))-I(4)*x5));
	I D=((I(4)*x4+(x3+x2-I(4)-x5-x4)*x3-I(4)*x5)*(-x2)+x1*(x4*(x3+x2+I(4)+x5-x1-x4)+(x2-I(4))*(x3-x5))+(x3*(x4-I(4))+I(16)+I(4)*x5-I(4)*x4)*(-x5))*((x4*(-x1)+I(8)*x5+x3*(I(2)*x2))*(x4*(I(16)*x1))-I(16)*(square(x2*x3-I(4)*x5)));

    #elif defined(case_2)
	I A=x3*(x2*(I(4)*x4+I(16)+I(4)*x5-I(4)*x2-I(4)*x3)+(I(2)*r-I(1))*(-I(8)*x3)+I(128)*r+(x4-I(4))*(-I(4)*x5)-I(64))+(x4+x2-I(4)-x5)*(I(16)*x5)+((x3-x5)*(-x2)+(r-I(1))*(-I(8)*x3)+(x4+x1-I(4)-x5-x2-x3)*x4+(I(2)*r-I(1))*(I(2)*x1)+I(16)-I(4)*x5-I(32)*r)*(-I(4)*x1)+I(128)+x4*(-I(16)*x2)-I(256)*r;
	I B=((I(2)*x2+(I(1)+r)*x3-I(4)*r-I(4)-I(2)*x5-I(2)*x4)*x2+(I(2)+I(2)*r-x4)*(-I(2)*x5)+(I(3)*r-I(1))*(-I(2)*x3)+I(48)*r-I(16))*(-I(4)*x3)+(I(2)*r+I(2)+x5-x2-x4)*(-I(32)*x5)+I(384)*r+x4*(-I(32)*x2)+((I(1)+r)*(I(4)*x5)+(I(5)*r-I(1))*(-I(4)*x3)+x2*((I(1)+r)*x3-I(2)*x5)+x4*(x1*(-I(1)-r)+I(2)*x2+(I(1)+r)*x3+I(4)*r+I(4)+I(2)*x5-I(2)*x4)+I(16)+(I(3)*r-I(1))*(I(2)*x1)-I(48)*r)*(I(4)*x1)-I(128);
	I C=x1*((I(2)*r-I(1))*(I(24)*x3)+I(64)*r+x2*((r-I(1))*(-I(4)*x3)-I(4)*x5)+x4*(x1*(x4+I(4)*r-I(4))+(r-I(1))*(-I(4)*x3)+(x3-I(2))*(-I(2)*x2)+I(16)-I(4)*x5-I(16)*r-I(4)*x4)+(r-I(1))*(-I(16)*x5)+(I(2)*r-I(1))*(-I(4)*x1)-I(32))+((x4+I(4)*r-I(4))*(-I(4)*x5)+(I(2)*r-I(1))*(-I(4)*x3)+x2*(I(4)*x4+x3*(x2+I(4)*r-I(4))-I(4)*x5)+I(32)*r-I(16))*(x3-I(4));
	I D=((x4+I(4)*r-I(2))*(x1*(x1*(x4+I(4)*r-I(2))+(x2+I(4)*r-I(2))*(-I(2)*x3)+I(16)-I(8)*x5-I(32)*r))+square(x3*(x2+I(4)*r-I(2))+I(8)-I(4)*x5-I(16)*r))*((I(4)*x4+(x3+x2-I(4)-x5-x4)*x3-I(4)*x5)*(I(16)*x2)+(x4*(x3+x2+I(4)+x5-x1-x4)+(x2-I(4))*(x3-x5))*(-I(16)*x1)+(x3*(x4-I(4))+I(16)+I(4)*x5-I(4)*x4)*(I(16)*x5));

    #elif defined(case_3)
	I A=x1*((I(4)*r-I(1))*(I(8)*x3)+x4*(I(4)*x3+I(8)+I(4)*x5-I(4)*x1-I(4)*x4)+(I(2)*r-I(1))*(-I(8)*x1)-I(8)*x5)+x0*((x0+x5-I(2)-x1-x3-x4)*(-I(4)*x5)+(x4+I(8)*r-I(4)-x3)*(I(4)*x1)+(I(2)*r-I(1))*(-I(8)*x0)+(I(4)*r-I(1))*(I(8)*x3)-I(8)*x4)+(x3*(I(4)*r)+x4*(x5-I(2))+I(4)-I(2)*x5)*(-I(4)*x3);
	I B=((r-I(1))*(I(2)*x3)+(x5-I(2))*(-x4)+I(2)*x5-I(4))*(I(8)*x3)+((I(5)*r-I(3))*(-I(2)*x3)+(I(3)*r-I(1))*(I(2)*x1)+x4*(x1*(-I(1)-r)+(I(1)+r)*x3+I(4)+I(2)*x5-I(2)*x4)-I(4)*x5)*(I(4)*x1)+x0*((x0*(I(1)+r)+x1*(-I(1)-r)+x3*(-I(1)-r)+I(2)*x5-I(4)-I(2)*x4)*(-I(4)*x5)+(I(5)*r-I(3))*(-I(8)*x3)+(I(3)*r-I(1))*(I(8)*x0)+(x4*(-I(1)-r)+I(12)*r+x3*(I(2)*r)-I(4))*(-I(4)*x1)-I(16)*x4);
	I C=(x4-I(2))*((x5-I(2))*(-I(4)*x3)+x1*(x1*(x4+I(4)*r-I(2))+I(4)*x5+x3*(-I(4)*r)-I(4)*x4))+(I(8)*x4+(x0*(I(4)*r+x5-I(4))+I(4)*x4+(x4+I(2)*r-I(2))*(-I(2)*x1)+x3*(-I(4)*r)+I(8)-I(4)*x5)*(-x5)+((r-I(1))*(-x4)+x3*(I(2)*r-I(1))+I(4)*r-I(2))*(-I(4)*x1)+(I(2)*r-I(1))*(I(4)*x0)+x3*(-I(8)*r))*(-x0);
	I D=(x0*((x3-x4)*(x1-I(2))+x5*(x0+x5-I(2)-x1-x3-x4))+(I(2)*x5+(x4+x1-I(2)-x5-x3)*x4-I(2)*x3)*x1+x3*(I(2)*x3+x4*(x5-I(2))+I(4)-I(2)*x5))*((x0*(I(4)*r+x5-I(2))+x3*(-I(8)*r)+(x4+I(4)*r-I(2))*(-I(2)*x1))*((I(4)*r+x5-I(2))*(I(16)*x0))+I(16)*(square(x3*(-I(4)*r)+x1*(x4+I(4)*r-I(2)))));

    #elif defined(case_4)
	I A=(I(2)*r-I(1))*(-I(8)*(square(x2)))+(x4+x2+I(16)*r-I(12)-x5)*(I(16)*x5)+(x4*(I(4)+x5-I(8)*r)+(I(2)*r-I(1))*(I(2)*x3)+(x3+x2+I(8)*r-I(8)-x5-x4)*x2-I(4)*x5)*(-I(4)*x3)+(r-I(1))*(x4*((r-I(1))*(I(4)*x4)+I(32)*x2))+(x2*(I(4)+x5-I(8)*r-x3)+(x4+x1+I(8)*r-I(8)-x5-x2-x3)*x4+(r-I(1))*(-I(8)*x3)+(I(2)*r-I(1))*(I(2)*x1)-I(4)*x5)*(-I(4)*x1);
	I B=(I(3)*r-I(1))*(I(8)*(square(x2)))+x3*((I(1)+r)*(I(16)*x5)+(I(3)*r-I(1))*(I(8)*x3)+(x4*(-I(1)-r)+(I(1)+r)*x3+(I(1)+r)*x2+I(4)-I(2)*x5-I(20)*r)*(-I(4)*x2)+(I(6)*r+x5-I(2))*(-I(8)*x4))+((I(1)+r)*(I(4)*x5)+(I(5)*r-I(1))*(-I(4)*x3)+x2*((I(1)+r)*x3+I(4)-I(2)*x5-I(12)*r)+((I(1)+r)*x1+(I(1)+r)*x4+x3*(-I(1)-r)+x2*(-I(1)-r)+I(4)-I(2)*x5-I(20)*r)*(-x4)+(I(3)*r-I(1))*(I(2)*x1))*(I(4)*x1)+(I(5)*r-I(1))*(x4*((r-I(2))*((I(-8)/I(7))*x4)-I(16)*x2))+((I(1)+r)*x4+(I(1)+r)*x2+I(8)-I(2)*x5-I(32)*r)*(I(16)*x5);
	I C=x3*(x4*(I(16)*r-I(8)-I(4)*x5)+(I(2)*r-I(1))*(-I(4)*x3)+(r-I(1))*(-I(16)*x5)+x2*((r-I(1))*(-I(4)*x4)+(r-I(1))*(I(4)*x3)+x2*(x3+I(4)*r-I(4))+I(24)-I(4)*x5-I(48)*r))+x1*(x4*(x1*(x4+I(4)*r-I(4))+(r-I(1))*(I(4)*x4)+(r-I(1))*(-I(4)*x3)+(x3+I(2)*r-I(2))*(-I(2)*x2)+I(24)-I(4)*x5-I(48)*r)+(I(2)*r-I(1))*(I(24)*x3)+x2*((r-I(1))*(-I(4)*x3)+I(16)*r-I(8)-I(4)*x5)+(I(2)*r-I(1))*(-I(4)*x1)+(r-I(1))*(-I(16)*x5))+(x2*(r-I(1))+x4*(r-I(1))+I(8)-I(16)*r)*(-I(16)*x5)+(I(2)*r-I(1))*(((I(5)+I(2)*r)*x4-x2)*((I(2)*r-I(1))*(I(4)*x4)+I(4)*x2));
	I D=((x1*(x4+I(4)*r-I(2))+(I(2)*r-I(1))*(I(4)*x4)+(I(2)*r-I(1))*(-I(4)*x3)+(x3+I(4)*r-I(2))*(-I(2)*x2)-I(8)*x5)*(x1*(x4+I(4)*r-I(2)))+(x4*(I(2)*r-I(1))+x3*(I(2)*r-I(1))+I(20)-x5-I(48)*r)*(-I(16)*x5)+(I(12)*r-I(5))*(-I(4)*(square(x3-x4)))+((I(2)*r-I(1))*(-I(4)*x4)+(I(2)*r-I(1))*(I(4)*x3)+x2*(x3+I(4)*r-I(2))-I(8)*x5)*(x2*(x3+I(4)*r-I(2))))*((I(4)*x4+(x3+x2-I(4)-x5-x4)*x3-I(4)*x5)*(I(16)*x2)+(x4*(x3+x2+I(4)+x5-x1-x4)+(x2-I(4))*(x3-x5))*(-I(16)*x1)+(x3*(x4-I(4))+I(16)+I(4)*x5-I(4)*x4)*(I(16)*x5));

    #elif defined(case_5)
	I A=x0*((x4+x3+I(16)*r-I(6)-x5-x0)*(I(4)*x5)+I(8)*x3-I(8)*x4)+(I(2)*r-I(1))*(-I(8)*(square(x4-I(2))))+x3*(x4*(I(32)*r-I(8)-I(4)*x5)+x3*(-I(16)*r)+I(16)+I(8)*x5-I(64)*r)+x1*((I(4)*r-I(1))*(I(8)*x3)+(x3-x5)*(-I(4)*x0)+I(64)*r+x4*(I(4)*x3+I(4)*x0+I(24)+I(4)*x5-I(32)*r-I(4)*x1-I(4)*x4)+(I(2)*r-I(1))*(-I(8)*x1)-I(32)-I(8)*x5);
	I B=((x1*(-I(1)-r)+x4*(-I(1)-r)+(I(1)+r)*x3+x0*(I(2)*r)+I(14)*r+I(2)*x5-I(2))*(-x4)+(I(5)*r-I(3))*(I(2)*x3)+(x3*(I(2)*r)+(I(1)+r)*(-x5))*x0+I(24)*r+(I(3)*r-I(1))*(-I(2)*x1)+I(4)*x5-I(8))*(-I(4)*x1)+(I(3)*r-I(1))*(I(8)*(square(x4-I(2))))+((x4*(-I(1)-r)+x3*(-I(1)-r)+x0*(I(2)*r)+I(22)*r+I(2)*x5-I(10))*(-x5)+x4*(-I(4)*r)+x3*(I(4)*r))*(I(4)*x0)+((r-I(1))*(I(2)*x3)+I(10)*r+(I(5)*r+x5-I(3))*(-x4)+I(2)*x5-I(6))*(I(8)*x3);
	I C=((I(2)*r-I(1))*(-x4)+x3*(I(2)*r-x5)+I(4)*r-I(2))*(I(4)*x4-I(8))+x1*(x4*((I(4)*r+x5-I(2))*(-I(2)*x0)+x1*(x4+I(4)*r-I(4))+(r-I(1))*(I(4)*x4)+x3*(-I(4)*r)+I(16)+I(4)*x5-I(24)*r)+I(32)*r+x3*(I(8)*r)+(I(2)*r-I(1))*(-I(4)*x1)+((r-I(1))*(-x5)+x3*(I(2)*r-I(1)))*(I(4)*x0)-I(16)-I(8)*x5)+((I(2)*r-I(1))*(-I(8)*x4)+(x0*(I(8)*r+x5-I(4))+(r-I(1))*(-I(4)*x4)+I(24)*r+x3*(-I(4)*r)-I(8)-I(4)*x5)*(-x5)+(I(2)*r-I(1))*(I(8)*x3))*(-x0);
	I D=(x0*(x5*(x0*(-x5)+(I(2)*r-I(1))*(I(4)*x4)+I(72)+x3*(I(8)*r)-I(176)*r))+(x0*(-I(2)*x5)+x1*(x4+I(4)*r-I(2))+(I(2)*r-I(1))*(I(4)*x4)+I(8)+x3*(-I(8)*r)-I(16)*r)*((x4+I(4)*r-I(2))*(-x1))+(I(2)*r-I(1))*(I(4)*(square(I(2)*x3+r*x4-I(2)*r))))*(((x3-x4)*(x1-I(2))+x5*(x0+x5-I(2)-x1-x3-x4))*(-I(16)*x0)+x1*(I(32)*x3+x4*(I(16)*x3+I(32)+I(16)*x5-I(16)*x1-I(16)*x4)-I(32)*x5)+(I(2)*x3+x4*(x5-I(2))+I(4)-I(2)*x5)*(-I(16)*x3));

    #elif defined(case_6)
	I A=x1*((I(2)*r-I(1))*(I(32)*x2)+(x4+x1+I(16)*r-I(8)-x0-x2-x3)*(-I(4)*x4)+(x2+I(8)*r-I(4)-x0)*(I(4)*x3)+(I(2)*r-I(1))*(-I(16)*x0)+(I(2)*r-I(1))*(-I(8)*x1))+(I(2)*r-I(1))*(x4*(I(32)*x3-I(8)*x4))+(I(2)*r-I(1))*(-I(8)*(square(x3)))+((I(2)*r-I(1))*(I(2)*x2)+x0*(x4+I(8)*r-I(4))+(I(2)*r-I(1))*(-I(4)*x4)+x3*(x3+x2+I(16)*r-I(8)-x0-x4))*(-I(4)*x2)+((I(2)*r-I(1))*(-x4)+(I(2)*r-I(1))*(-x3)+I(144)*r+x0*(I(2)*r-I(1))-I(60))*(I(16)*x0);
	I B=x1*((r-I(1))*(I(16)*x2)+x4*(x1*(-I(4)-I(4)*r)+x4*(-I(4)-I(4)*r)+x3*(I(4)+I(4)*r)+x0*(I(8)*r)+I(16)+x2*(I(4)+I(4)*r)-I(16)*r)+x3*(x0*(-I(8)*r)+I(16)+x2*(I(4)+I(4)*r)-I(48)*r)+(I(3)*r-I(1))*(I(16)*x0)+(I(3)*r-I(1))*(I(8)*x1))+(r-I(1))*(x4*(x4*(-I(8)*r)+I(16)*x3))+(I(3)*r-I(1))*(I(8)*(square(x3)))+((I(3)*r-I(1))*(-x4)+(I(3)*r-I(1))*(-x3)+I(40)*r+(I(5)*r-I(2))*(I(2)*x0)-I(16))*(-I(16)*x0)+((I(3)*r-I(1))*(-I(2)*x2)+(I(3)*r-I(1))*(I(4)*x4)+((I(1)+r)*x4+x3*(-I(1)-r)+x0*(I(2)*r)+I(4)+x2*(-I(1)-r)-I(4)*r)*(-x3)+x0*(I(4)+x4*(I(2)*r)-I(12)*r))*(-I(4)*x2);
	I C=(I(2)*r-I(1))*(((I(5)+I(2)*r)*x4-x3)*((I(2)*r-I(1))*(I(4)*x4)+I(4)*x3))+(x4*(I(7)*r-I(3))+x3*(I(7)*r-I(3))+I(40)-I(96)*r)*(-I(16)*x0)+(((r-I(1))*(-I(4)*x4)+(r-I(1))*(I(4)*x3)+x2*(x3+I(4)*r-I(4))+I(24)+(I(2)*r-I(1))*(I(4)*x0)-I(48)*r)*x3+(I(2)*r-I(1))*(-I(4)*x2)+(I(2)*r-I(1))*(I(8)*x4)+(x4*(I(2)*r-I(1))+I(12)-I(28)*r)*(I(4)*x0))*x2+((I(2)*r-I(1))*(-I(24)*x2)+x4*((x4+I(4)*r-I(4))*(-x1)+(r-I(1))*(-I(4)*x4)+(r-I(1))*(I(4)*x3)+I(48)*r+(x3+I(2)*r-I(2))*(I(2)*x2)+(I(2)*r-I(1))*(-I(4)*x0)-I(24))+((r-I(1))*(-x2)+I(4)*r+x0*(I(2)*r-I(1))-I(2))*(-I(4)*x3)+(I(7)*r-I(3))*(I(16)*x0)+(I(2)*r-I(1))*(I(4)*x1))*(-x1);
	I D=((x3+I(4)*r-I(2))*(((I(2)*r-I(1))*(-I(4)*x4)+(I(2)*r-I(1))*(I(4)*x3)+(I(2)*r-I(1))*(I(8)*x0)+x2*(x3+I(4)*r-I(2)))*x2)+(x4+I(4)*r-I(2))*((x1*(x4+I(4)*r-I(2))+(I(2)*r-I(1))*(I(4)*x4)+(I(2)*r-I(1))*(-I(4)*x3)+(I(2)*r-I(1))*(I(8)*x0)+(x3+I(4)*r-I(2))*(-I(2)*x2))*x1)+(x4*(I(12)*r-I(5))+x3*(I(12)*r-I(5))+I(116)+x0*(I(12)*r-I(5))-I(280)*r)*(-I(16)*x0)+(I(12)*r-I(5))*(-I(4)*(square(x3-x4))))*(((x3+I(8)*r-I(4)-x4)*(-x1)+(I(2)*r-I(1))*(-I(4)*x4)+(I(2)*r-I(1))*(-I(4)*x3)+I(192)*r+(x4+I(8)*r-I(4)-x3)*(-x2)+(I(2)*r-I(1))*(I(4)*x0)-I(80))*(-I(16)*x0)+x3*((x3+x2+I(8)*r-I(4)-x4)*(I(16)*x2)+(I(2)*r-I(1))*(-I(64)*x4))+x1*((x3+I(8)*r-I(4))*(-I(16)*x2)+(x4+x1+I(8)*r-I(4)-x2-x3)*(I(16)*x4)));

    #elif defined(case_7)
	I A=((-I(4)*x5)*(x0-I(2)-x1-x3+x5)+(-I(4)*x3)*(x1-I(2)))*x0+(-I(8)*x3)*((-x5)*(I(4)*r-I(1))+I(2)-x1+(I(2)*r)*x3)+((-I(8)*x5)*(I(2)*r-I(1))-I(8)*x1)*x5+(I(4)*x4)*((I(8)*r-I(4)+x0-x3)*x5+(I(2)*x3)*(I(4)*r-I(1))-I(2)*x0+(-I(2)*x4)*(I(2)*r-I(1))+(x0+I(2)-x1+x3-x4+x5)*x1);
	I B=(-I(4)*x0)*(((I(2)*r)*x3)*(x1-I(2))+((I(2)*r)*x0-I(4)*r+(-I(2)*r)*x1+(r+I(1))*x5+(-x3)*(r+I(1)))*x5)+(-I(4)*x4)*((I(2)*x3)*(I(5)*r-I(3))+(-x5)*(I(4)-I(12)*r+(r+I(1))*x0-I(2)*x3)+(-x1)*((I(2)*r)*x0+I(4)*r+(-I(2)*r)*x1+(-x4)*(r+I(1))+(r+I(1))*x5+(r+I(1))*x3)+(I(4)*r)*x0+(-I(2)*x4)*(I(3)*r-I(1)))+(I(8)*x3)*((I(2)*x3)*(r-I(1))-I(4)*r+(-x5)*(I(5)*r-I(3))+(I(2)*r)*x1)+((-I(8)*r)*(I(2)*x1+(r-I(1))*x5))*x5;
	I C=(x0-I(2))*(x5*((I(8)*r-I(4)+x5)*x0+(I(2)*x5)*(I(2)*r-I(1))+(-I(4)*x1)*(I(2)*r-I(1)))+(I(4)*x3)*(I(2)-I(4)*r+(-r)*x5+(I(2)*r-I(1))*x1))+((-I(4)*x4)*(I(2)*r-I(1))+(-I(4)*x5)*(I(2)-I(4)*r+(r-I(1))*x0+x3)+(I(8)*r)*x3+(I(8)*x0)*(I(2)*r-I(1))+(-x1)*(I(16)*r-I(8)+(I(4)*x5)*(r-I(1))+(-I(4)*x4)*(r-I(1))+(I(4)*r)*x3+(-x1)*(I(8)*r-I(4)+x4)+(I(2)*x0)*(I(4)*r-I(2)+x5)))*x4;
	I D=(((-I(16)*x4)*(x5-I(2))-I(64)-I(32)*x3+I(32)*x5)*x3+(-I(16)*x1)*(I(2)*x5-I(2)*x3+(x1-I(2)-x3+x4-x5)*x4)+(-I(16)*x0)*((x1-I(2))*(x3-x4)+(x0-I(2)-x1-x3-x4+x5)*x5))*((x4*((-x4)*(I(4)*r-I(2)+x1)+(I(8)*r)*x3+(I(2)*x5)*(I(4)*r-I(2)+x0)))*(I(4)*r-I(2)+x1)-square((-x5)*(I(4)*r-I(2)+x0)+(I(4)*r)*x3));

    #elif defined(case_8)
	I A=I(3712)-I(8960)*r+(-I(4)*x3)*(I(80)-I(192)*r+(I(2)*x3)*(I(2)*r-I(1))+(I(8)*r-I(4)+x1)*x0+(-x4)*(I(16)*r-I(8)+x1)+(I(8)*r-I(4)-x0-x1+x2+x3-x4)*x2)+(I(16)*x0)*(I(48)*r-I(20)+(I(2)*r-I(1))*x0+(-x2)*(I(2)*r-I(1))+(-x1)*(I(2)*r-I(1)))+(-I(4)*x4)*(I(80)-I(192)*r+(I(8)*r-I(4)+x2)*x0+(I(2)*x4)*(I(2)*r-I(1))+(I(8)*r-I(4)-x0+x1-x2+x4)*x1)+((I(16)*x1)*x2)*(I(2)*r-I(1));
	I B=I(12672)*r-I(5248)+(-I(32)*x0)*(I(34)*r-I(14)+(I(5)*r-I(2))*x0+(-x2)*(I(5)*r-I(2))+(-x1)*(I(5)*r-I(2)))+((-I(32)*x1)*x2)*(I(5)*r-I(2))+(-I(4)*x3)*(I(272)*r-I(112)+(-I(2)*x3)*(I(3)*r-I(1))+(-x4)*(I(4)*r-I(4)+(r+I(1))*x1)+(-x2)*(I(12)*r-I(4)+(I(2)*r)*x0+(I(2)*r)*x1+(r+I(1))*x4+(-I(2)*r)*x2+(-x3)*(r+I(1)))+(I(2)*x0)*(I(2)-I(6)*r+x1*r))+(-I(4)*x4)*(I(272)*r-I(112)+(I(2)*x0)*(I(2)-I(6)*r+x2*r)+(-I(2)*x4)*(I(3)*r-I(1))+(-x1)*(I(12)*r-I(4)+(I(2)*r)*x0+(-I(2)*r)*x1+(-x4)*(r+I(1))+(I(2)*r)*x2));
	I C=(I(384)*r-I(160)+(-I(4)*x3)*(I(2)*r-I(1))+(I(4)*x0)*(I(12)-I(28)*r+(I(2)*r-I(1))*x1)+(I(48)-I(112)*r+(I(4)*x3)*(r-I(1))+(-I(4)*x4)*(r-I(1))+(I(4)*x0)*(I(2)*r-I(1))+(-I(2)*x1)*(I(4)*r-I(2)+x4)+(I(8)*r-I(4)+x3)*x2)*x2+(-I(4)*x4)*(I(6)-I(12)*r+(r-I(1))*x1))*x3+(I(192)*r-I(80)+((x1-I(2))*x4)*(I(4)*r-I(2)+x1)+(I(4)*x0)*(I(12)-I(28)*r+(I(2)*r-I(1))*x2+(I(2)*r-I(1))*x1)+((-I(4)*x1)*x2)*(I(2)*r-I(1)))*(I(8)*r-I(4)+x4);
	I D=(((-I(16)*x3)*(I(80)-I(192)*r+(I(8)*x0)*(I(2)*r-I(1))+(-I(2)*x4)*(I(4)*r-I(2)+x1)+(I(4)*r-I(2)+x2)*x3))*(I(4)*r-I(2)+x2)-I(16)*(square(I(40)-I(96)*r+(I(4)*x0)*(I(2)*r-I(1))+(I(4)*r-I(2)+x1)*x4)))*((I(192)*r-I(80)+(-I(4)*x3)*(I(2)*r-I(1))+(-I(4)*x4)*(I(2)*r-I(1))+(I(4)*x0)*(I(2)*r-I(1))+(-x1)*(I(8)*r-I(4)+x3-x4)+(-x2)*(I(8)*r-I(4)-x3+x4))*x0+((I(4)*x4)*(I(2)*r-I(1))+(-x2)*(I(8)*r-I(4)+x2+x3-x4))*x3+((I(8)*r-I(4)+x3)*x2+(-x4)*(I(8)*r-I(4)+x1-x2-x3+x4))*x1);

    #elif defined(case_9)
	I A=(I(4)*x0)*(I(192)*r-I(80)+(-I(4)*x3)*(I(2)*r-I(1))+(-I(4)*x4)*(I(2)*r-I(1))+(I(4)*x0)*(I(2)*r-I(1))+(-x1)*(I(8)*r-I(4)+x3-x4)+(-x2)*(I(8)*r-I(4)-x3+x4))+((I(16)*x4)*(I(2)*r-I(1))+(-I(4)*x2)*(I(8)*r-I(4)+x2+x3-x4))*x3+(I(4)*x1)*((I(8)*r-I(4)+x3)*x2+(-x4)*(I(8)*r-I(4)+x1-x2-x3+x4));
	I B=((-I(8)*r)*((-I(4)*x4)*(I(2)*r-I(1))+(I(8)*r-I(4)+x2+x3-x4)*x2))*x3+(I(8)*x1)*((-x4)*(I(8)-I(20)*r+(-r)*x3+x1*r+x4*r+(-r)*x2)+(x2*r)*(I(8)*r-I(4)+x3))+(-I(8)*x0)*(I(464)*r-I(192)+(-I(4)*x3)*(I(5)*r-I(2))+(-I(4)*x4)*(I(5)*r-I(2))+(I(4)*x0)*(I(5)*r-I(2))+(I(8)-I(20)*r+x3*r+(-r)*x4)*x1+(-x2)*(I(20)*r-I(8)+x3*r+(-r)*x4));
	I C=((I(80)-I(192)*r+(-I(4)*x3)*(I(2)*r-I(1))+(I(4)*x4)*(I(2)*r-I(1))+(I(4)*x0)*(I(2)*r-I(1))+(I(8)*r-I(4)+x4)*x1+(-I(2)*x2)*(I(4)*r-I(2)+x3))*x4+((I(4)*x0-I(4)*x2)*(I(8)*r-I(4)+x3))*(I(2)*r-I(1)))*x1+(I(8)*r-I(4)+x2)*((I(4)*x0)*(I(20)-I(48)*r+(I(2)*r-I(1))*x3+(I(2)*r-I(1))*x4)+((I(8)*r-I(4)+x3)*x2+(-I(4)*x4)*(I(2)*r-I(1)))*x3);
	I D=((-I(128)*x0)*((-I(2)*x0)*(I(12)*r-I(5))+(x3*x2)*(I(2)*r-I(1))+(x4*x1)*(I(2)*r-I(1)))-I(16)*(square(x3*x2+(-x1)*x4)))*((I(192)*r-I(80)+(-I(4)*x3)*(I(2)*r-I(1))+(-I(4)*x4)*(I(2)*r-I(1))+(I(4)*x0)*(I(2)*r-I(1))+(-x1)*(I(8)*r-I(4)+x3-x4)+(-x2)*(I(8)*r-I(4)-x3+x4))*x0+((I(4)*x4)*(I(2)*r-I(1))+(-x2)*(I(8)*r-I(4)+x2+x3-x4))*x3+((I(8)*r-I(4)+x3)*x2+(-x4)*(I(8)*r-I(4)+x1-x2-x3+x4))*x1);

    #endif

    /****************************************************************/
    /* update R (0,1 or 2 values) and return the updated block list */
    /****************************************************************/

    std::vector<block> Bi;
    
    std::vector<I> Xi=trinome(A,B,C,D,hull(I(0),r)); // compute R
    for (auto& R: Xi)
    {
        Bl[6]=R; // update R
        Bi.push_back(Bl);
    }

    return Bi;
}

